#######################################################
#             Verify software versions                #
#######################################################

anta.tests.software:
  - VerifyEOSVersion:
      versions:
        - 4.33.1F-39308076.liffeyceoslabarm (engineering build)
  - VerifyTerminAttrVersion:
      versions:
        - v1.35.99_devel

#######################################################
#               Verify field notices                  #
#######################################################
anta.tests.field_notices:
  - VerifyFieldNotice44Resolution:
  - VerifyFieldNotice72Resolution:

#######################################################
#               Verify routing model                  #
#######################################################
anta.tests.routing:
  generic:
    - VerifyRoutingProtocolModel:
        model: multi-agent

#######################################################
#             Verify environmental settings           #
#######################################################
anta.tests.hardware:
  - VerifyTransceiversManufacturers:
      manufacturers:
        - Not Present
        - Arista Networks
  - VerifyTemperature:
  - VerifyTransceiversTemperature:
  - VerifyEnvironmentSystemCooling:
  - VerifyEnvironmentCooling:
      states:
        - ok
  - VerifyEnvironmentPower:
      states:
        - ok

anta.tests.system:
  - VerifyUptime: # Verifies the device uptime is higher than a value.
      minimum: 300
  - VerifyNTP:
  - VerifyReloadCause:
  - VerifyCoredump:
  - VerifyAgentLogs:
  # - VerifyCPUUtilization: ############# CPU is always high on cEOS

anta.tests.services:
  - VerifyDNSLookup:
      domain_names:
        - arista.com
        - google.com
        - arista.io

anta.tests.security:
  - VerifyAPIHttpStatus:
  - VerifyTelnetStatus:
  - VerifyBannerMotd:
        motd_banner: |
            This is a super secure network, behave or you'll get in big trouble.

  - VerifyIPv4ACL:
      ipv4_access_lists:
        - name: SNMP
          entries:
            - sequence: 10
              action: permit host 10.0.100.10
            - sequence: 20
              action: permit host 10.0.100.20
            - sequence: 30
              action: permit host 10.0.100.30

anta.tests.snmp:
  - VerifySnmpStatus:
      vrf: default
  - VerifySnmpContact:
      contact: "Information Technology"

anta.tests.stp:
  - VerifySTPMode:
      mode: rapidPvst
      vlans:
        - 1
        - 10
        - 30
        - 50
  - VerifySTPBlockedPorts:
  - VerifySTPCounters:

anta.tests.mlag:
  - VerifyMlagStatus:
  - VerifyMlagInterfaces:
  - VerifyMlagConfigSanity:

anta.tests.interfaces:
  - VerifyInterfaceUtilization:
  # - VerifyInterfaceErrors:
  # - VerifyInterfaceDiscards:
  - VerifyInterfaceErrDisabled:
  - VerifyIllegalLACP:
  - VerifyPortChannels:

anta.tests.connectivity:
  - VerifyReachability:
      hosts:
        - source: Management0
          destination: 1.1.1.1
          vrf: MGMT
        - source: Management0
          destination: 8.8.8.8
          vrf: MGMT

#######################################################
#               Verify LLDP neighbors                 #
#######################################################

  - VerifyLLDPNeighbors:
      neighbors:
        - port: Ethernet1
          neighbor_device: PDT_LEAF1.Hosting_XYZ.com
          neighbor_port: Ethernet1
        - port: Ethernet2
          neighbor_device: PDT_LEAF2.Hosting_XYZ.com
          neighbor_port: Ethernet1
        - port: Ethernet3
          neighbor_device: PDT_LEAF3.Hosting_XYZ.com
          neighbor_port: Ethernet1
        - port: Ethernet4
          neighbor_device: PDT_LEAF4.Hosting_XYZ.com
          neighbor_port: Ethernet1
        - port: Ethernet47
          neighbor_device: PDT_SPINE2.Hosting_XYZ.com
          neighbor_port: Ethernet47
        - port: Ethernet48
          neighbor_device: PDT_SPINE2.Hosting_XYZ.com
          neighbor_port: Ethernet48
      filters:
        tags: ['spine1']

  - VerifyLLDPNeighbors:
      neighbors:
        - port: Ethernet1
          neighbor_device: PDT_LEAF1.Hosting_XYZ.com
          neighbor_port: Ethernet2
        - port: Ethernet2
          neighbor_device: PDT_LEAF2.Hosting_XYZ.com
          neighbor_port: Ethernet2
        - port: Ethernet3
          neighbor_device: PDT_LEAF3.Hosting_XYZ.com
          neighbor_port: Ethernet2
        - port: Ethernet4
          neighbor_device: PDT_LEAF4.Hosting_XYZ.com
          neighbor_port: Ethernet2
        - port: Ethernet47
          neighbor_device: PDT_SPINE1.Hosting_XYZ.com
          neighbor_port: Ethernet47
        - port: Ethernet48
          neighbor_device: PDT_SPINE1.Hosting_XYZ.com
          neighbor_port: Ethernet48
      filters:
        tags: ['spine2']

  - VerifyLLDPNeighbors:
      neighbors:
        - port: Ethernet1
          neighbor_device: PDT_SPINE1.Hosting_XYZ.com
          neighbor_port: Ethernet1
        - port: Ethernet2
          neighbor_device: PDT_SPINE2.Hosting_XYZ.com
          neighbor_port: Ethernet1
        - port: Ethernet47
          neighbor_device: PDT_LEAF2.Hosting_XYZ.com
          neighbor_port: Ethernet47
        - port: Ethernet48
          neighbor_device: PDT_LEAF2.Hosting_XYZ.com
          neighbor_port: Ethernet48
      filters:
        tags: ['leaf1']

  - VerifyLLDPNeighbors:
      neighbors:
        - port: Ethernet1
          neighbor_device: PDT_SPINE1.Hosting_XYZ.com
          neighbor_port: Ethernet2
        - port: Ethernet2
          neighbor_device: PDT_SPINE2.Hosting_XYZ.com
          neighbor_port: Ethernet2
        - port: Ethernet47
          neighbor_device: PDT_LEAF1.Hosting_XYZ.com
          neighbor_port: Ethernet47
        - port: Ethernet48
          neighbor_device: PDT_LEAF1.Hosting_XYZ.com
          neighbor_port: Ethernet48
      filters:
        tags: ['leaf2']

  - VerifyLLDPNeighbors:
      neighbors:
        - port: Ethernet1
          neighbor_device: PDT_SPINE1.Hosting_XYZ.com
          neighbor_port: Ethernet3
        - port: Ethernet2
          neighbor_device: PDT_SPINE2.Hosting_XYZ.com
          neighbor_port: Ethernet3
        - port: Ethernet47
          neighbor_device: PDT_LEAF4.Hosting_XYZ.com
          neighbor_port: Ethernet47
        - port: Ethernet48
          neighbor_device: PDT_LEAF4.Hosting_XYZ.com
          neighbor_port: Ethernet48
      filters:
        tags: ['leaf3']

  - VerifyLLDPNeighbors:
      neighbors:
        - port: Ethernet1
          neighbor_device: PDT_SPINE1.Hosting_XYZ.com
          neighbor_port: Ethernet4
        - port: Ethernet2
          neighbor_device: PDT_SPINE2.Hosting_XYZ.com
          neighbor_port: Ethernet4
        - port: Ethernet47
          neighbor_device: PDT_LEAF3.Hosting_XYZ.com
          neighbor_port: Ethernet47
        - port: Ethernet48
          neighbor_device: PDT_LEAF3.Hosting_XYZ.com
          neighbor_port: Ethernet48
      filters:
        tags: ['leaf4']

anta.tests.configuration:
  - VerifyZeroTouch: # Verifies ZeroTouch is disabled.
  # - VerifyRunningConfigDiffs:
  - VerifyRunningConfigLines:
      regex_patterns:
        - "vrf instance MGMT"
        - "terminal length 40"
        - "event-monitor"
        - "snmp-server community MY_COMMUNITY ro SNMP"
        - "service routing protocols model multi-agent"
        - "logging buffered 10000 notifications"
        - "logging trap debugging"
        - "logging console notifications"
        - "logging format timestamp traditional year"
        - "username admin privilege 15 role network-admin secret sha512"
        - "username tech privilege 15 role network-admin secret sha512"
        - "username test privilege 15 role network-admin secret sha512"
        - "ip name-server vrf MGMT 8.8.8.8"
        - "ip name-server vrf MGMT 208.67.222.222"
        - "dns domain Hosting_XYZ.com"
        - "sflow sample 2000"
        - "sflow polling-interval 20"
        - "sflow destination 127.0.0.1"
        - "sflow run"
        - "aaa authorization exec default local"
        - "ntp server vrf MGMT pool.ntp.org iburst"
        - "ntp server vrf MGMT time.google.com prefer iburst"
